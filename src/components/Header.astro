---
import ThemeToggle from '@/components/ThemeToggle.astro'
import { Astronav, MenuIcon, MenuItems } from 'astro-navbar'
import CarbonParameter from '~icons/carbon/parameter'

// TODO: Import auth client when Better Auth is configured
// import { authClient } from '@/lib/auth-client'

const pathname = Astro.url.pathname

const navItems = [
  { href: '/', label: 'Home' },
  { href: '/blog', label: 'Blog' },
  { href: '/profile', label: 'Profile' },
  { href: '/gh-stats', label: 'Status' },
]

function isActive(href: string): boolean {
  if (href === '/') return pathname === '/'
  return pathname.startsWith(href)
}
---

<header
  class="sticky top-0 z-40 mx-auto w-full justify-between gap-5 border-b bg-background/95 p-5 backdrop-blur supports-[backdrop-filter]:bg-background/60 lg:flex"
  role="banner"
>
  <Astronav>
    <div class="flex w-full justify-between lg:w-auto">
      <a
        href="/"
        class="flex items-center space-x-2 transition-opacity hover:opacity-80"
        aria-label="Home"
      >
        <CarbonParameter class="mr-2 h-10 w-10" />
      </a>
      <div class="ml-auto flex items-center space-x-4">
        <MenuIcon class="order-2 h-6 w-6 cursor-pointer lg:hidden" />
        <div class="order-1 lg:ml-4 lg:hidden"><ThemeToggle /></div>
      </div>
    </div>

    <MenuItems class="hidden lg:flex lg:flex-grow lg:justify-end">
      <nav aria-label="Main navigation">
        <ul class="flex flex-col lg:w-full lg:flex-row lg:gap-1">
          {navItems.map((item) => (
            <li>
              <a
                href={item.href}
                class:list={[
                  'block rounded-md px-3 py-2 text-sm font-medium transition-colors',
                  isActive(item.href)
                    ? 'bg-accent text-accent-foreground'
                    : 'text-muted-foreground hover:bg-accent hover:text-accent-foreground'
                ]}
                aria-current={isActive(item.href) ? 'page' : undefined}
              >
                {item.label}
              </a>
            </li>
          ))}
        </ul>
      </nav>
    </MenuItems>
    <div class="hidden lg:flex lg:items-center lg:pl-4">
      <ThemeToggle />
    </div>
  </Astronav>
</header>
